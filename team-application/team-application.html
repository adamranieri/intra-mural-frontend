<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="team-application.css" />
    <title>Team Application</title>
</head>
<body>
    <h1>Teams</h1>
    <table>
        <thead>
            <th>Name</th>
            <th>Sport</th>
            <th>Team Status</th>
        </thead>
        <tbody id="teamInfo">
        </tbody>
    </table>

    <a href="../option-page/option-page.html">Back</a>
</body>
<script src="../http-requests.js"></script>
<script src="../dynamic-html.js"></script>
<script>
    async function populateTable() {
        teams = await retrieveAllTeams();
        let tbody = document.getElementById('teamInfo');

        for (team of teams) {
            tbody.innerHTML += teamTableRowHTML(team);
        }
    }

    // 2 functions pertaining to showing and removing Captain Information below
    // showCaptainInfo is linked to the onclick attribute of the "See The Captain" button
    async function showCaptainInfo(id) {
        let body = document.getElementsByTagName('body')[0];

        let stats = await retrieveStatsForPlayer(id);
        console.log(stats);

        removeCaptainInfo();

        let captainInfoSection = (
            `<section>
                <button onclick="removeCaptainInfo()">Close</button>
                <p>Player Id: ${stats.id}</p>
                <p>Username: ${stats.username}</p>
                ${stats.hideBiometrics === false ? `<p>Height (inches): ${stats.heightInches}</p> <p>Weight (lbs): ${stats.weightLbs}</p>` : ''}
                ${stats.profilePic != 'none' ? `<img src="${stats.profilePic}" />` : ''}
            </section>`
        );

        body.innerHTML += captainInfoSection;
    }

    function removeCaptainInfo() {
        if (document.getElementsByTagName('section').length > 0) {
            let captainInfo = document.getElementsByTagName('section')[0];

            if (captainInfo) {
                captainInfo.parentNode.removeChild(captainInfo);
            }
        }
    }

    populateTable();
</script>
</html>